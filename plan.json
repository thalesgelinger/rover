{
  "version": "2.0",
  "lastUpdated": "2026-01-21",
  "totalPhases": 11,
  "completedPhases": 3,
  "focusAreas": ["TUI (Phase 2)", "Web/WASM (Phase 3)", "Modifiers (Phase 4)", "Events (Phase 5)", "Performance/GC (Phase 10)"],
  "excludedFromCurrentScope": ["iOS Renderer (Phase 6)", "Android Renderer (Phase 7)", "Animations (Phase 8)"],
  "agentInstructions": {
    "overview": "Rover is a cross-platform UI framework with Lua scripting and Rust core. The reactive system uses signals (NOT virtual DOM diffing). Changes flow: Signal → Subscribers notified → Derived marked dirty → Effects scheduled → Nodes updated → RenderCommands emitted → Platform applies commands.",
    "architecture": {
      "signalRuntime": "rover-ui/src/signal/runtime.rs - Central reactive coordinator with arena, graph, derived, effects, batching, node bindings",
      "nodeArena": "rover-ui/src/node/arena.rs - Tree structure storage (Text, Column, Row, Conditional, Each)",
      "renderCommands": "rover-ui/src/node/commands.rs - Declarative mutations (UpdateText, Show, Hide, InsertChild, etc.)",
      "platformHandler": "rover-ui/src/platform/ - Trait for platform abstraction (TUI implemented, Web pending)",
      "renderer": "rover-ui/src/renderer/ - Renderer trait + TUI implementation using ratatui",
      "layoutEngine": "rover-ui/src/layout/engine.rs - Simple flexbox-style layout (Column=vertical, Row=horizontal)",
      "luaBindings": "rover-ui/src/lua/ - signal.rs, derived.rs, effect.rs, ui.rs for Lua API"
    },
    "keyLimitation": "Lua comparison operators (__lt, __le, __eq) MUST return boolean. Use rover.derive() for reactive comparisons, NOT direct comparison operators.",
    "testingStrategy": {
      "tui": "Use sandbox mode to test TUI without actual terminal. Mock terminal output, verify RenderCommands.",
      "web": "Use wasm-pack test --headless --chrome for WASM testing. Verify DOM operations via web-sys."
    },
    "currentImplementationState": {
      "phase0": "COMPLETE - Platform abstractions, generic event loop, TUI platform handler",
      "phase1": "COMPLETE - Signal arena, subscriber graph, derived signals, effects, Lua bindings with metamethods",
      "phase2": "PARTIAL - Node system exists (Text, Column, Row, Conditional, Each). TuiRenderer exists with ratatui. Layout engine is basic. Need: ui.button, input handling, proper command flow, tests",
      "phase3": "NOT STARTED - Need rover-web crate, wasm-bindgen setup, WebRenderer",
      "phase4": "NOT STARTED - Need ModifierChain, tokens, TokenResolver trait",
      "phase5": "NOT STARTED - Need EventType enum, input components, two-way binding"
    }
  },
  "phases": [
    {
      "id": 0,
      "name": "Event Loop Refactoring + Platform Abstractions",
      "filename": "phases/phase-0.md",
      "pass": true,
      "duration": "1 semana",
      "dependencies": "Nenhuma",
      "deliverables": [
        { "id": "0.1", "name": "Platform Abstractions", "pass": true },
        { "id": "0.2", "name": "Generic Event Loop", "pass": true },
        { "id": "0.3", "name": "TUI Renderer Refactoring", "pass": true },
        { "id": "0.4", "name": "Signal Runtime Extensions", "pass": true },
        { "id": "0.5", "name": "Signal Value Fix", "pass": true }
      ]
    },
    {
      "id": 1,
      "name": "Signal System (Rust Core)",
      "filename": "phases/phase-1.md",
      "pass": true,
      "duration": "2-3 semanas",
      "deliverables": [
        {
          "id": "1.1",
          "name": "Signal Arena (Storage)",
          "pass": true,
          "checklist": [
            { "item": "Criar signal com valor inicial", "pass": true },
            { "item": "Ler valor via .val", "pass": true },
            { "item": "Escrever valor via .val =", "pass": true },
            { "item": "Zero allocation em read/write", "pass": true }
          ]
        },
        {
          "id": "1.2",
          "name": "Subscriber Graph",
          "pass": true,
          "checklist": [
            { "item": "Registrar dependencia signal → subscriber", "pass": true },
            { "item": "Notificar subscribers quando signal muda", "pass": true },
            { "item": "Propagacao em cascata (A → B → C)", "pass": true },
            { "item": "Sem notificacao se valor nao mudou", "pass": true }
          ]
        },
        {
          "id": "1.3",
          "name": "Derived Signals",
          "pass": true,
          "checklist": [
            { "item": "derive(fn) cria signal computado", "pass": true },
            { "item": "Recomputa quando dependencias mudam", "pass": true },
            { "item": "Lazy evaluation (so computa quando lido)", "pass": true },
            { "item": "Cache de valor (nao recomputa se limpo)", "pass": true }
          ]
        },
        {
          "id": "1.4",
          "name": "Magic Metamethods (Lua Bindings)",
          "pass": true,
          "checklist": [
            { "item": "__add, __sub, __mul, __div, __mod, __unm", "pass": true },
            { "item": "__concat", "pass": true },
            { "item": "__eq, __lt, __le", "pass": true },
            { "item": "__tostring", "pass": true }
          ]
        },
        {
          "id": "1.5",
          "name": "Effects",
          "pass": true,
          "checklist": [
            { "item": "Effect roda uma vez no registro", "pass": true },
            { "item": "Effect re-roda quando dependencias mudam", "pass": true },
            { "item": "Tracking automatico de dependencias", "pass": true },
            { "item": "Cleanup function opcional", "pass": true }
          ]
        },
        {
          "id": "1.6",
          "name": "Utilities (any, all, none)",
          "pass": true,
          "checklist": []
        }
      ]
    },
    {
      "id": 2,
      "name": "UI Core + TUI Renderer",
      "filename": "phases/phase-2.md",
      "pass": true,
      "duration": "2-3 semanas",
      "dependencies": "Phase 1, Phase 0",
      "implementationNotes": "COMPLETE: Node system, TuiRenderer, signal-to-node binding, process_node_updates(), render command processing integrated with event loop. Granular update tests passing.",
      "deliverables": [
        { "id": "2.1", "name": "Node System", "pass": true, "notes": "NodeArena with Text, Column, Row, Conditional, Each implemented" },
        { "id": "2.2", "name": "Render Commands", "pass": true, "notes": "UpdateText, Show, Hide, InsertChild, RemoveChild, MountTree, ReplaceEach" },
        { "id": "2.3", "name": "Signal → Node Binding", "pass": true, "notes": "subscribe_node() and schedule_node_update() in SignalRuntime" },
        { "id": "2.4", "name": "Componentes Lua Basicos", "pass": true, "notes": "ui.text, ui.column, ui.row, ui.when, ui.each registered" },
        { "id": "2.5", "name": "TUI Renderer", "pass": true, "notes": "TuiRenderer with ratatui, handles commands, renders tree" },
        { "id": "2.6", "name": "Layout Basico (Column/Row)", "pass": true, "notes": "LayoutEngine with simple divide-equally strategy" },
        { "id": "2.7", "name": "Verify & Test", "pass": true, "notes": "Sandbox tests complete, granular update tests pass, process_node_updates() integrated with event loop" }
      ]
    },
    {
      "id": 3,
      "name": "Web Renderer (DOM)",
      "filename": "phases/phase-3.md",
      "pass": true,
      "duration": "2 semanas",
      "dependencies": "Fase 2",
      "implementationNotes": "COMPLETE: rover-web crate created with wasm-bindgen. WebRenderer implemented using web-sys. WebPlatform with event handling. Ready for browser testing. TODO: Add CLI integration for seamless 'rover file.lua --platform web' experience.",
      "deliverables": [
        { "id": "3.1", "name": "WASM Build Setup", "pass": true, "notes": "Cargo.toml configured with cdylib, wasm-bindgen dependencies" },
        { "id": "3.2", "name": "Web Renderer Implementation", "pass": true, "notes": "WebRenderer with DOM element mapping, render command handling" },
        { "id": "3.3", "name": "Event Handling (Web)", "pass": true, "notes": "WebPlatform with keyboard events, requestAnimationFrame loop" },
        { "id": "3.4", "name": "CLI Dev Server Integration", "pass": false, "notes": "TODO: 'rover file.lua --platform web' should auto-compile WASM, serve on localhost:4242 using rover-server infrastructure, no generated files (use .rover/ for cache). Just works like TUI." }
      ]
    },
    {
      "id": 4,
      "name": "Styling Modifiers",
      "filename": "phases/phase-4.md",
      "pass": false,
      "duration": "2-3 semanas",
      "dependencies": "Fase 3",
      "deliverables": [
        { "id": "4.1", "name": "Modifier Chain System", "pass": false },
        { "id": "4.2", "name": "Lua Chainable API", "pass": false },
        { "id": "4.3", "name": "Token → Platform Value Mapping", "pass": false },
        { "id": "4.4", "name": "Modifier → RenderCommand", "pass": false },
        { "id": "4.5", "name": "Conditional Modifiers (:when)", "pass": false }
      ]
    },
    {
      "id": 5,
      "name": "Events e Interatividade",
      "filename": "phases/phase-5.md",
      "pass": false,
      "duration": "1-2 semanas",
      "dependencies": "Fase 4",
      "deliverables": [
        { "id": "5.1", "name": "Event Types", "pass": false },
        { "id": "5.2", "name": "Event → Modifier Trigger", "pass": false },
        { "id": "5.3", "name": "Input Components", "pass": false },
        { "id": "5.4", "name": "Two-Way Binding", "pass": false }
      ]
    },
    {
      "id": 6,
      "name": "iOS Renderer (UIKit)",
      "filename": "phases/phase-6.md",
      "pass": false,
      "duration": "3-4 semanas",
      "dependencies": "Fase 5",
      "excludedFromCurrentScope": true,
      "deliverables": [
        { "id": "6.1", "name": "Rust → Swift/ObjC Bridge", "pass": false },
        { "id": "6.2", "name": "iOS Renderer Implementation", "pass": false },
        { "id": "6.3", "name": "Layout (Auto Layout/Manual)", "pass": false },
        { "id": "6.4", "name": "Token Resolver iOS", "pass": false }
      ]
    },
    {
      "id": 7,
      "name": "Android Renderer",
      "filename": "phases/phase-7.md",
      "pass": false,
      "duration": "2-3 semanas",
      "dependencies": "Fase 5",
      "excludedFromCurrentScope": true,
      "deliverables": [
        { "id": "7.1", "name": "Rust → JNI Bridge", "pass": false },
        { "id": "7.2", "name": "Android Renderer Implementation", "pass": false }
      ]
    },
    {
      "id": 8,
      "name": "Animation Modifiers",
      "filename": "phases/phase-8.md",
      "pass": false,
      "duration": "3-4 semanas",
      "dependencies": "Fase 6, Fase 7",
      "excludedFromCurrentScope": true,
      "deliverables": [
        { "id": "8.1", "name": "Timing Modifiers", "pass": false },
        { "id": "8.2", "name": "Animated Properties", "pass": false },
        { "id": "8.3", "name": "Animation Loop", "pass": false },
        { "id": "8.4", "name": "Platform Animation Integration", "pass": false },
        { "id": "8.5", "name": "Lua API", "pass": false }
      ]
    },
    {
      "id": 9,
      "name": "HTTP e Async",
      "filename": "phases/phase-9.md",
      "pass": false,
      "duration": "2 semanas",
      "dependencies": "Fase 5",
      "deliverables": [
        { "id": "9.1", "name": "Async Runtime Integration", "pass": false },
        { "id": "9.2", "name": "Lua HTTP API", "pass": false },
        { "id": "9.3", "name": "Effect + HTTP", "pass": false }
      ]
    },
    {
      "id": 10,
      "name": "Polish e Otimizacoes",
      "filename": "phases/phase-10.md",
      "pass": false,
      "duration": "Continua",
      "dependencies": "Nenhuma",
      "deliverables": [
        { "id": "10.1", "name": "List Virtualization", "pass": false },
        { "id": "10.2", "name": "Batch Updates", "pass": false },
        { "id": "10.3", "name": "DevTools", "pass": false },
        { "id": "10.4", "name": "Error Boundaries", "pass": false },
        { "id": "10.5", "name": "RegistryKey Cleanup", "pass": false }
      ]
    }
  ],
  "notes": {
    "importantLimitation": "Comparison operators cannot create reactive signals. Use rover.derive() instead.",
    "estimatedTotalDuration": "5-7 meses para MVP",
    "threadingNote": "Multi-threading (Lynx-Style) planned for future phases",
    "branchInfo": "Development on ui/tui branch, targeting main via PRs"
  }
}
